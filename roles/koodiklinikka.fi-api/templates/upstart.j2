description "koodiklinikka.fi API"
author      "Riku Rouvila <riku.rouvila@gmail.com>"

start on runlevel [2345]
stop on runlevel [016]

respawn
respawn limit 10 5
env NODE_ENV=production
env PORT={{ koodiklinikka_api_port }}
exec su -s /bin/bash -c 'source {{ koodiklinikka_api_nvm_script }} && nvm use {{ koodiklinikka_api_project_name }} && cd {{ koodiklinikka_api_app_path }} && exec "$0" "$@"' {{ koodiklinikka_api_user }} -- \
    node index.js \
    >> /var/log/{{ koodiklinikka_api_project_name }}.log 2>&1
